<!DOCTYPE html>
<html lang="fr">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Pieces Auto</title>
	<link rel="stylesheet" href="./css/style.css">
	<script type="module" src="./js/index.js" defer></script>
	<meta name="description" content="Application de pieces auto">
	<link rel="icon" type="image/webp" href="./assets/icon/iconj.webp" />
</head>

<body>
	<header class="header">
		<div class="container">
			<a href="#"><img class="header__img" src="assets/icon/carRed.webp" width="500" height="250" alt="LOGO"></a>
			<div class="header__wrapper">
				<h1 class="header__heading"><a href="#">Pieces Auto</a></h1>
				<a class="basket" href="./html/cart.html" aria-label="Logo panier">
					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
						<path
							d="M253.3 35.1c6.1-11.8 1.5-26.3-10.2-32.4s-26.3-1.5-32.4 10.2L117.6 192H32c-17.7 0-32 14.3-32 32s14.3 32 32 32L83.9 463.5C91 492 116.6 512 146 512H430c29.4 0 55-20 62.1-48.5L544 256c17.7 0 32-14.3 32-32s-14.3-32-32-32H458.4L365.3 12.9C359.2 1.2 344.7-3.4 332.9 2.7s-16.3 20.6-10.2 32.4L404.3 192H171.7L253.3 35.1zM192 304v96c0 8.8-7.2 16-16 16s-16-7.2-16-16V304c0-8.8 7.2-16 16-16s16 7.2 16 16zm96-16c8.8 0 16 7.2 16 16v96c0 8.8-7.2 16-16 16s-16-7.2-16-16V304c0-8.8 7.2-16 16-16zm128 16v96c0 8.8-7.2 16-16 16s-16-7.2-16-16V304c0-8.8 7.2-16 16-16s16 7.2 16 16z" />
					</svg>
					<span class="showTotal font-bold">0</span>
				</a>
			</div>
		</div>
	</header>

	<main class="main__home">
		<!-- Menu de recherche -->
		<section class="filtres border">
			<div>
				<h2>Filtres</h2>
				<div class="wrapper">
					<button class="btn border btn-try">Trier par prix croissants</button>
					<button class="btn border btn-detry">Trier par prix décroissants</button>
					<button class="btn border btn-dispo">Filtrer les pièces disponible</button>
					<button class="btn border btn-new">Filtrer les pièces nouvelles</button>
					<label for="rangePrice">
						<p class="font-bold">Prix</p>
						<div class="rangePrice">
							<span class="rangePrice__min">5 </span>
							<input type="range" name="price" id="rangePrice" min="5" max="200" step="5" value="200">
							<span class="rangePrice__max"> 200</span>
						</div>
						<p class="font-bold">Value: <output class="rangePricevalue" id="rangePricevalue"></output></p>
					</label>
				</div>
			</div>
			<details>
				<summary>Données</summary>
				<div class="graphs">
					<div class="graph">
						<h2>Aperçu des avis</h2>
						<div>
							<canvas id="graph-avis" height="250"></canvas>
						</div>
					</div>
					<div class="graph">
						<h2>Aperçu des pieces disponible</h2>
						<div>
							<canvas id="graph-dispo" height="250"></canvas>
						</div>
					</div>
				</div>
			</details>
			<details>
				<summary>Formulaire avis</summary>
				<form class="form">
					<div class="form__alert font-bold animatedALerte">Ce formulaire n'est pas fonctionnel non connecté à
						une base
						de données</div>
					<label for="form__pieceId">
						Identifiant de la pièce :<br>
						<input type="number" name="form__pieceId" id="form__pieceId" required min="1" max="5">
					</label>
					<label for="form__user">
						Nom d'utilisateur :<br>
						<input type="text" name="form__user" id="form__user" required>
					</label>
					<label for="form__comment">
						Avis :<br>
						<input type="text" name="form__comment" id="form__comment" required>
					</label>
					<label for="form__nbStar">
						Nombre d'étoiles :<br>
						<input type="number" name="form__nbStar" id="form__nbStar" required min="1" max="5">
					</label>
					<button class="btn border">Envoyer</button>
				</form>
			</details>
		</section>

		<!-- Cards produits -->
		<section class="cards"></section>
		<!-- Template Card -->
		<template id="card-tmp">

			<div class="card">
				<div class="card__container border">
					<a class="card__link" href="">
						<div class="card__new animatedALerte">Nouveau</div>
						<img class="card__img" src="" alt="" width="500" height="130">
						<div class="card__body">
							<h3 class="card__heading"></h3>
							<p class="card__id"></p>
							<p class="card__price font-bold"></p>
							<p class="card__category"></p>
							<p class="card__description"></p>
							<p class="card__available font-bold"></p>
						</div>
					</a>
					<button class="card__btn btn border">Afficher les 3 derniers avis</button>
				</div>
				<div class="card__avis"></div>
			</div>

		</template>
		<!-- Template Card -->

	</main>
	<footer class="footer">
		<div class="container">
			<a href="#"><img class="footer__img" src="assets/icon/carRed.webp" width="500" height="250" alt="LOGO"></a>
			<h1 class="footer__heading"><a href="#">Pieces Auto</a></h1>
			<p>Visitez mon portfolio sur <b><a href="https://jimmypro.fr">jimmypro.fr</a></b></p>
			<p>Conçu par Jimmy Clairy, tous droits réservés 2023 ©</p>
		</div>
	</footer>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.3.0/chart.umd.min.js"></script>
	<script type="module">
		import { chartAvis, chartPieces } from "./js/chart.js"
		import { fetchData } from "./js/fetchData.js"

		// Graphique pour les avis
		const allAvis = await fetchData("./dataBase/avis.json")
		const nbCommentaires = [0, 0, 0, 0, 0]

		for (let avis of allAvis) {
			nbCommentaires[avis.nbEtoiles - 1]++
		}
		nbCommentaires.reverse()
		const ctx = document.getElementById("graph-avis");
		chartAvis(ctx, nbCommentaires, "y")

		// Graphique pour les pieces
		const pieces = await fetchData("./dataBase/pieces.json")
		const nbPiecesDispo = [0, 0]

		for (let piece of pieces) {
			piece.disponibilite ? nbPiecesDispo[0]++ : nbPiecesDispo[1]++
		}
		const ctx1 = document.getElementById("graph-dispo");
		chartPieces(ctx1, nbPiecesDispo)
	</script>
</body>

</html>