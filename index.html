<!DOCTYPE html>
<html lang="fr">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Pieces Auto</title>
	<link rel="stylesheet" href="./css/style.css">
	<script type="module" src="app.js" defer></script>
	<meta name="description" content="Application de pieces auto">
</head>

<body>
	<header class="header">
		<div class="container">
			<img class="header__img" src="images/car.jpg" alt="LOGO">
			<div class="header__wrapper">
				<h1 class="header__heading">Pieces Auto</h1>
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
					<path
						d="M253.3 35.1c6.1-11.8 1.5-26.3-10.2-32.4s-26.3-1.5-32.4 10.2L117.6 192H32c-17.7 0-32 14.3-32 32s14.3 32 32 32L83.9 463.5C91 492 116.6 512 146 512H430c29.4 0 55-20 62.1-48.5L544 256c17.7 0 32-14.3 32-32s-14.3-32-32-32H458.4L365.3 12.9C359.2 1.2 344.7-3.4 332.9 2.7s-16.3 20.6-10.2 32.4L404.3 192H171.7L253.3 35.1zM192 304v96c0 8.8-7.2 16-16 16s-16-7.2-16-16V304c0-8.8 7.2-16 16-16s16 7.2 16 16zm96-16c8.8 0 16 7.2 16 16v96c0 8.8-7.2 16-16 16s-16-7.2-16-16V304c0-8.8 7.2-16 16-16zm128 16v96c0 8.8-7.2 16-16 16s-16-7.2-16-16V304c0-8.8 7.2-16 16-16s16 7.2 16 16z" />
				</svg>
			</div>
		</div>
	</header>
	<main>
		<!-- Menu de recherche -->
		<section class="filtres border">
			<div>
				<h2>Filtres</h2>
				<div class="wrapper">
					<button class="btn border btn-try">Trier par prix croissants</button>
					<button class="btn border btn-detry">Trier par prix décroissants</button>
					<button class="btn border btn-dispo">Filtrer les pièces disponible</button>
					<button class="btn border btn-new">Filtrer les pièces nouvelles</button>
					<label for="rangePrice">
						<p class="font-bold">Prix</p>
						<div class="rangePrice">
							<span class="rangePrice__min">5 </span>
							<input type="range" name="price" id="rangePrice" min="5" max="200" step="5" value="200">
							<span class="rangePrice__max"> 200</span>
						</div>
						<p class="font-bold">Value: <output class="rangePricevalue" id="rangePricevalue"></output></p>
					</label>
				</div>
			</div>
			<details>
				<summary>Données</summary>
				<div class="graphs">
					<div class="graph">
						<h2>Aperçu des avis</h2>
						<div>
							<canvas id="graph-avis" width="150" height="150"></canvas>
						</div>
					</div>
					<div class="graph">
						<h2>Aperçu des pieces disponible</h2>
						<div>
							<canvas id="graph-dispo" width="150" height="150"></canvas>
						</div>
					</div>
				</div>
				<button class="btn border btn-maj">Mettre à jour les pièces</button>
			</details>
			<details>
				<summary>Formulaire avis</summary>
				<form class="form">
					<div class="form__alert animatedALerte">Ce formulaire n'est pas fonctionnel non connecté à une base
						de données</div>
					<label for="form__pieceId">
						Identifiant de la pièce :<br>
						<input type="number" name="form__pieceId" id="form__pieceId" required min="1" max="5">
					</label>
					<label for="form__user">
						Nom d'utilisateur :<br>
						<input type="text" name="form__user" id="form__user" required>
					</label>
					<label for="form__comment">
						Avis :<br>
						<input type="text" name="form__comment" id="form__comment" required>
					</label>
					<label for="form__nbStar">
						Nombre d'étoiles :<br>
						<input type="number" name="form__nbStar" id="form__nbStar" required min="1" max="5">
					</label>
					<button class="btn border">Envoyer</button>
				</form>
			</details>
		</section>

		<!-- Cards produits -->
		<section class="cards"></section>

	</main>
	<footer class="footer">
		<div class="container">
			<img class="footer__img" src="images/car.jpg" alt="LOGO">
			<h1 class="footer__heading">Pieces Auto</h1>
		</div>
	</footer>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.3.0/chart.umd.min.js"></script>
	<script>
		async function chart1() {
			const dataFetch0 = await fetch("db.json").then(res => res.json())

			const nbCommentaires = [0, 0, 0, 0, 0]

			for (let commentaire of dataFetch0.avis) {
				nbCommentaires[commentaire.nbEtoiles - 1]++
			}

			const ctx = document.getElementById("graph-avis");
			new Chart(ctx, {
				type: "bar",
				data: {
					labels: ["5", "4", "3", "2", "1"],
					datasets: [{
						label: "Étoiles attribuées",
						data: nbCommentaires.reverse(),
						backgroundColor: [
							"#ff2a2a33",
							"#00000033",
							"#d4af3733",
							"#c0c0c033",
							" #b8733333"
						],
						borderColor: [
							"#ff2a2a",
							"#000",
							"#d4af37",
							"#c0c0c0",
							" #b87333",
						],
						borderWidth: 1
					}]
				},
				options: {
					indexAxis: "y",
				}
			});
		}
		chart1()

		async function chart2() {
			const dataFetch1 = await fetch("db.json").then(res => res.json())
			const nb_piecesDispo = [0, 0]
			for (let piece of dataFetch1.pieces) {
				piece.disponibilite ? nb_piecesDispo[0]++ : nb_piecesDispo[1]++
			}

			const ctx = document.getElementById("graph-dispo");

			new Chart(ctx, {
				type: "bar",
				data: {
					labels: ["Disponible", "Non disponible"],
					datasets: [{
						label: "Pieces disponible",
						data: nb_piecesDispo,
						backgroundColor: [
							"#ff2a2a33",
							"#00000033"
						],
						borderColor: [
							"#ff2a2a",
							"#000"
						],
						borderWidth: 1
					}]
				}
			});
		}
		chart2()

	</script>
</body>

</html>